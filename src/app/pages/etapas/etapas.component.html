<div class="w-full h-full mt-20">
  <mat-tab-group>
    <mat-tab label="Etapas">
      <div class="grid grid-cols-2 gap-4">
        <div class="flex my-20">
          <div class="flex flex-col">
            <button
              z-button
              zShape="square"
              zSize="lg"
              class="bg-sky-200 w-60 mr-4 text-start flex p-0 m-0 justify-between mb-10 shadow-md"
              (click)="agregarEtapa()"
            >
              <p class="pl-8 font-bold text-sky-700 mt-3">AGREGAR ETAPA</p>
              <div
                class="p-0 m-0 bg-sky-700 !text-white w-10 h-10 text-center flex"
              >
                <svg
                  viewBox="0 0 24 24"
                  fill="none"
                  xmlns="http://www.w3.org/2000/svg"
                  class="!text-white m-auto !w-6 !h-6"
                >
                  <g id="SVGRepo_bgCarrier" stroke-width="0"></g>
                  <g
                    id="SVGRepo_tracerCarrier"
                    stroke-linecap="round"
                    stroke-linejoin="round"
                  ></g>
                  <g id="SVGRepo_iconCarrier">
                    <path
                      d="M6 12H18M12 6V18"
                      stroke="#000000"
                      stroke-width="2"
                      stroke-linecap="round"
                      stroke-linejoin="round"
                    ></path>
                  </g>
                </svg>
              </div>
            </button>
            <mat-form-field class="w-full">
              <mat-label>Periodo</mat-label>
              <select matNativeControl required>
                <option value="dias">Días</option>
                <option value="semanas">Semanas</option>
                <option value="meses">Meses</option>
                <option value="anos">Años</option>
              </select>
            </mat-form-field>
          </div>
          <div>
            <button
              z-button
              zShape="square"
              zSize="lg"
              class="bg-lime-200 w-40 mr-4 text-start flex p-0 m-0 justify-between shadow-md"
              (click)="onSubmit()"
            >
              <p class="pl-8 font-bold text-lime-600 mt-3">GUARDAR</p>
              <div
                class="p-0 m-0 bg-lime-600 text-white w-10 h-10 text-center flex"
              >
                <svg
                  fill="#000000"
                  viewBox="0 0 24 24"
                  xmlns="http://www.w3.org/2000/svg"
                  class="text-white m-auto !w-6 !h-6"
                >
                  <g id="SVGRepo_bgCarrier" stroke-width="0"></g>
                  <g
                    id="SVGRepo_tracerCarrier"
                    stroke-linecap="round"
                    stroke-linejoin="round"
                  ></g>
                  <g
                    id="SVGRepo_iconCarrier"
                    class="text-white m-auto w-10 h-10"
                  >
                    <path
                      d="M21,20V8.414a1,1,0,0,0-.293-.707L16.293,3.293A1,1,0,0,0,15.586,3H4A1,1,0,0,0,3,4V20a1,1,0,0,0,1,1H20A1,1,0,0,0,21,20ZM9,8h4a1,1,0,0,1,0,2H9A1,1,0,0,1,9,8Zm7,11H8V15a1,1,0,0,1,1-1h6a1,1,0,0,1,1,1Z"
                    ></path>
                  </g>
                </svg>
              </div>
            </button>
          </div>
        </div>
        <div class="my-20 relative">
          <svg
            width="64px"
            height="64px"
            viewBox="0 0 128 128"
            xmlns="http://www.w3.org/2000/svg"
            xmlns:xlink="http://www.w3.org/1999/xlink"
            aria-hidden="true"
            role="img"
            class="iconify iconify--noto absolute top-0 left-0 mt-2 ml-4"
            preserveAspectRatio="xMidYMid meet"
            fill="#000000"
          >
            <g id="SVGRepo_bgCarrier" stroke-width="0"></g>
            <g
              id="SVGRepo_tracerCarrier"
              stroke-linecap="round"
              stroke-linejoin="round"
            ></g>
            <g id="SVGRepo_iconCarrier">
              <ellipse
                cx="64"
                cy="116.87"
                rx="12.09"
                ry="7.13"
                fill="#424242"
              ></ellipse>
              <path
                d="M64 4C42.92 4 25.82 19.67 25.82 38.99c0 5.04 1.52 10.43 3.75 15.18c3.13 6.68 6.54 11.62 7.54 13.44c2.78 5.06 2.38 10.39 3.15 13.73c1.45 6.24 5.79 8.5 23.73 8.5s21.8-2.15 23.41-7.9c1.1-3.91.03-8.18 2.8-13.23c1-1.82 5.07-7.85 8.21-14.54c2.23-4.75 3.75-10.14 3.75-15.18C102.18 19.67 85.08 4 64 4z"
                fill="#ffd600"
              ></path>
              <ellipse
                cx="64"
                cy="86.13"
                rx="21.94"
                ry="4.46"
                fill="#b26500"
              ></ellipse>
              <ellipse
                cx="64"
                cy="86.13"
                rx="21.94"
                ry="4.46"
                fill="#b26500"
              ></ellipse>
              <ellipse
                cx="64"
                cy="86.13"
                rx="15.99"
                ry="2.06"
                fill="#ffa000"
              ></ellipse>
              <g fill="none" stroke-width="2" stroke-miterlimit="10">
                <path
                  d="M53.3 56.77c-.62 1.56-2.23 4.77-1.39 6.21c1.95 3.35 6.6 4.55 6.6 7.63c0 4.7-3.42 19.93-3.42 19.93"
                  stroke="#b26500"
                ></path>
                <path
                  d="M74.03 56.21s2.24 4.8 1.29 6.95c-.71 1.6-4.98 4.18-5.53 4.61c-2.55 2 .84 22.78.84 22.78"
                  stroke="#b26500"
                ></path>
                <path
                  d="M53.3 56.77c3.44-6.8 5.21-22.32.84-21.53c-7.37 1.33 1.71 26.83 6.18 23.9s10.01-23.85 3.21-23.93c-6.8-.08.46 26.66 5.08 23.69c3.65-2.35 12.56-23.66 5.24-23.66c-6.23 0 .19 20.97.19 20.97"
                  stroke="#ffffff"
                ></path>
              </g>
              <path
                d="M85.89 87.06S80.13 89.84 64 89.84s-21.89-2.78-21.89-2.78s-.36 5.14.83 7.47c1.43 2.8 2.53 3.77 2.53 3.77l.6 2.85l-.24.75c-.31.98-.09 2.06.6 2.83l.52.58l.58 2.74l-.2.55c-.38 1.05-.12 2.22.66 3.02l.38.39l.47 2.24s2.38 5.08 15.16 5.08s15.16-5.08 15.16-5.08l.04-.19l.26-.26c.52-.51.69-1.27.44-1.95l-.15-.39l.62-2.96l1.09-1.15c.54-.57.66-1.41.31-2.11l-.5-.99l.63-2.97l.4-.31c.59-.65.6-1.63.34-2.3c-.2-.53-.04-1.13.37-1.52c.63-.6 1.44-1.51 2.04-2.64c1.23-2.29.84-7.45.84-7.45z"
                fill="#82aec0"
              ></path>
              <path
                d="M45.47 98.3l.54 2.87c5.82-.03 13.59.26 28.5-2.11c2.69-.61 5.92-1.82 2.35-1.32c0-.01-13.69 1.3-31.39.56z"
                fill="#2f7889"
              ></path>
              <path
                d="M47.47 108.07c6.44-.11 19.6-.75 33.74-3.82l.63-2.97c-14.79 3.36-28.7 3.96-34.95 4.04l.58 2.75z"
                fill="#2f7889"
              ></path>
              <path
                d="M80.31 108.49c-13.09 2.84-25.34 3.57-31.97 3.73l.43 2.04s.21 6.33 15.16 6.33s15.16-6.33 15.16-6.33s-6.38 1.82-14.23.93a.63.63 0 0 1-.01-1.26c4.69-.62 10.29-1.54 14.84-2.48l.62-2.96z"
                fill="#2f7889"
              ></path>
              <path
                d="M42.18 87.06s6.46 2.78 21.76 2.78s21.88-2.78 21.88-2.78"
                fill="none"
                stroke="#82aec0"
                stroke-width="3.997"
                stroke-linecap="round"
                stroke-miterlimit="10"
              ></path>
              <path
                d="M49.88 10.32c3.91-.96 8-.48 10.8 2.92c.79.96 1.4 2.1 1.54 3.34c.28 2.39-1.2 4.65-2.96 6.31c-5.02 4.74-12.15 7.04-15.39 13.58c-.76 1.53-1.36 3.18-2.52 4.43c-1.16 1.25-3.09 2.01-4.6 1.21c-.8-.42-1.35-1.21-1.8-2c-2.84-5.06-2.63-11.51-.13-16.75c2.75-5.74 8.78-11.5 15.06-13.04z"
                fill="#ffff8d"
              ></path>
              <path
                d="M46.45 91.93c-.88-.4-.53-1.72.43-1.65c3.22.25 8.7.56 15.95.56c7.64 0 14.36-.57 18.28-.99c.97-.1 1.34 1.23.45 1.64c-3.02 1.42-8.55 3.04-18.03 3.04c-9.25 0-14.35-1.37-17.08-2.6z"
                fill="#ffd600"
              ></path>
              <path
                d="M51.94 102.03c-.67.24-1.36.57-1.7 1.19c-.12.23-.19.49-.14.75c.08.38.43.65.78.82c.7.34 1.49.43 2.26.44c1.59.02 3.17-.28 4.74-.58c.47-.09.95-.18 1.37-.41c.42-.23.78-.62.85-1.09c.1-.63-.35-1.24-.9-1.54c-1.9-1.05-5.34-.27-7.26.42z"
                fill="#94d1e0"
              ></path>
              <path
                d="M53.43 108.62c-.67.24-1.36.57-1.7 1.19c-.12.23-.19.49-.14.75c.08.38.43.65.78.82c.7.34 1.49.43 2.26.44c1.59.02 3.17-.28 4.74-.58c.47-.09.95-.18 1.37-.41c.42-.23.78-.62.85-1.09c.1-.63-.35-1.24-.9-1.54c-1.9-1.04-5.35-.26-7.26.42z"
                fill="#94d1e0"
              ></path>
              <path
                d="M50.01 84.2c.91.09 1.87.01 2.64-.48s1.26-1.49.95-2.35c-.16-.45-.51-.81-.85-1.15c-.75-.74-1.5-1.48-2.24-2.22c-.83-.83-1.66-1.65-2.56-2.4c-1.39-1.16-3.26-2.25-5.09-1.4c-1.56.72-1.93 2.14-1.24 3.63c1.47 3.13 4.89 6.01 8.39 6.37z"
                fill="#ffff8d"
              ></path>
            </g>
          </svg>
          <z-alert
            zTitle=""
            zDescription="De clic en los puntos para editar las etapas que fueron ingresadas en la matricula de proyectos e ingresar la duración y fecha de inicio, si desea adicionar otra etapa presione el botón Agregar Etapa"
            zType="warning"
            zAppearance="outline"
            class="pt-3 pl-20 h-20"
          />
        </div>
      </div>
    </mat-tab>
  </mat-tab-group>

  <mat-accordion class="my-8">
    @for (etapa of etapasArray.controls; track $index) {
    <mat-expansion-panel>
      <mat-expansion-panel-header class="!h-16">
        <mat-panel-title>
          <button
            matIconButton
            [matMenuTriggerFor]="menu"
            aria-label="Example icon-button with a menu"
          >
            <mat-icon>more_vert</mat-icon>
          </button>
          <mat-menu #menu="matMenu">
            <button mat-menu-item>
              <span>Editar</span>
            </button>
          </mat-menu>
          {{ etapa.get("etapa")?.value || "Sin título" }}
        </mat-panel-title>
      </mat-expansion-panel-header>
      <div class="p-20 pb-8 text-green-700 px-40 mx-auto w-full flex flex-col">
        <h1>Está editando una etapa</h1>
      </div>
      <div class="p-20 pt-0 px-40 mx-auto w-full flex flex-col">
        <div class="flex gap-4 mb-4 w-full">
          <mat-form-field class="w-1/2">
            <mat-label>Etapa</mat-label>
            <input
              matInput
              placeholder="Etapa"
              [formControl]="$any(etapa.get('etapa'))"
            />
          </mat-form-field>
          <mat-form-field class="w-1/2">
            <mat-label>Descripcion</mat-label>
            <input
              matInput
              placeholder="Descripcion"
              [formControl]="$any(etapa.get('descripcion'))"
            />
          </mat-form-field>
        </div>
        <z-alert
          zTitle=""
          zDescription="Indique la fecha de inicio y la duración de la etapa, el sistema realizará de forma automática el cálculo de la fecha fin. Por defecto la etapa tiene habilitada la ejecución presupuestal. Puede modificar el orden de ejecución"
          zType="info"
          zAppearance="soft"
          class="mb-4 border-blue-200 border"
        />
        <div class="flex gap-4 mb-4 w-full">
          <mat-form-field class="w-1/2">
            <mat-label>Duración</mat-label>
            <input
              matInput
              placeholder="Duración"
              [formControl]="$any(etapa.get('duracion'))"
            />
          </mat-form-field>
          <mat-form-field class="w-1/2">
            <mat-label>Ejecución Presupuestal</mat-label>
            <select
              matNativeControl
              required
              [formControl]="$any(etapa.get('ejecucionPresupuestal'))"
            >
              <option value="si">Si</option>
              <option value="no">No</option>
            </select>
          </mat-form-field>
        </div>
        <div class="flex gap-4 mb-4 w-full">
          <mat-form-field class="w-1/2">
            <mat-label>Fecha Inicio</mat-label>
            <input
              matInput
              type="date"
              [formControl]="$any(etapa.get('fechaInicio'))"
            />
          </mat-form-field>
          <mat-form-field class="w-1/2">
            <mat-label>Fecha Fin</mat-label>
            <input
              matInput
              type="date"
              [formControl]="$any(etapa.get('fechaFin'))"
            />
          </mat-form-field>
        </div>
      </div>
    </mat-expansion-panel>
    } @empty {
    <p>Aún no hay etapas creadas</p>
    }
  </mat-accordion>
</div>
